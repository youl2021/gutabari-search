import streamlit as st
import pandas as pd

# â”€â”€ 0) ì—‘ì…€ ê²½ë¡œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
DATA_FILE = "êµ¬íƒ€ë°”ë¦¬_ì‘í’ˆì„ ì •.xlsx"      # ê°™ì€ í´ë”ì— ë‘ì—ˆì„ ë•Œ

# â”€â”€ 1) ë¹„ë°€ë²ˆí˜¸ ì„¤ì •  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
PASSWORD = "9999"                        # í•„ìš”í•˜ë©´ ë³€ê²½

# ì„¸ì…˜ì— ë¡œê·¸ì¸ ì—¬ë¶€ ì €ì¥
if "auth_ok" not in st.session_state:
    st.session_state["auth_ok"] = False

if not st.session_state["auth_ok"]:
    st.title("ğŸ”’ êµ¬íƒ€ë°”ë¦¬ ì‘í’ˆì„ ì • (ë³´ì•ˆì ‘ì†)")
    pwd = st.text_input("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”", type="password")
    if pwd == PASSWORD:
        st.session_state["auth_ok"] = True
        st.experimental_rerun()
    elif pwd:                             # ë­”ê°€ ì…ë ¥í–ˆê³  í‹€ë ¸ì„ ë•Œ
        st.warning("âŒ ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.")
    st.stop()                             # ë¹„ë²ˆ ë§ì„ ë•Œê¹Œì§€ ì•„ë˜ ì½”ë“œ ì‹¤í–‰ ì•ˆ ë¨

# â”€â”€ 2) ê²€ìƒ‰ê¸° ë³¸ë¬¸  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.title("ğŸ¬ êµ¬íƒ€ë°”ë¦¬ ì‘í’ˆì„ ì •")

# ì—‘ì…€ ì½ê¸°
df = pd.read_excel(DATA_FILE)

query = st.text_input("ì˜í™” ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”")

if query:
    # ì œëª© ì»¬ëŸ¼ì— ì…ë ¥ì–´ê°€ í¬í•¨ëœ í–‰ ì¶”ì¶œ
    result = df[df["ì˜í™”ëª…"].str.contains(query, case=False, na=False)]

    if not result.empty:
        st.markdown("### âœ… ê²€ìƒ‰ ê²°ê³¼:")
        # ê²€ìƒ‰ëœ ê° í–‰ì„ â€œì¹´ë“œâ€ í˜•íƒœë¡œ ì¶œë ¥
        for _, row in result.iterrows():
            st.markdown(
f"""
---
ğŸ“½ **ì˜í™”ì œëª©** : {row['ì˜í™”ëª…']}  
ğŸ“‚ **ë¶„ì•¼** : {row['ë¶„ì•¼']}  
ğŸ **ì¥ë¥´** : {row['ì¥ë¥´']}  
ğŸ—“ **ì œì‘ì—°ë„** : {row['ì œì‘ì—°ë„']} / **ì œì‘êµ­ê°€** : {row['ì œì‘êµ­ê°€']}  
ğŸŒ **ì˜í™”ëª…(ì˜ë¬¸)** : {row['ì˜í™”ëª…(ì˜ë¬¸)']}
"""
            )
    else:
        st.markdown("### ì! **ë“œê°€ì~** ğŸ˜")
